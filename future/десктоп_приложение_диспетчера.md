# Десктоп приложение для диспетчера/логиста

## Обзор
Electron-приложение для Windows и macOS для диспетчеров и логистов, работающих с планированием рейсов и управлением флотом.

## Технологический стек
- **Framework**: Electron 28
- **Frontend**: React 18 + TypeScript
- **State Management**: Zustand
- **UI Library**: Ant Design / shadcn/ui
- **Maps**: Leaflet.js + MapBox
- **Real-time**: Socket.io Client
- **Local Storage**: SQLite (для кэширования)

## Зачем нужно десктоп приложение?

### Преимущества перед веб-версией
1. **Оффлайн-режим**: Работа без интернета с синхронизацией при подключении
2. **Производительность**: Нативная отрисовка карт, быстрее веб-версии на 30-40%
3. **Системные интеграции**:
   - Горячие клавиши (Ctrl+N для нового рейса)
   - Системные уведомления (критические алерты)
   - Печать документов напрямую на принтер
4. **Удобство**: Отдельное окно, всегда под рукой, не теряется среди вкладок браузера
5. **Безопасность**: Локальное хранение токенов, сертификаты для подписи

## Основные функции

### 1. Карта с флотом в реальном времени
- Все транспортные средства на карте
- Траектории движения
- Геозоны (погрузка, разгрузка, склады)
- Тепловая карта загруженности дорог
- Исторический трек (replay)

### 2. Планирование рейсов
- Создание нового рейса (drag & drop)
- Назначение водителя и ТС
- Оптимизация маршрута (AI)
- Расчет времени и стоимости
- Календарь рейсов (Gantt chart)

### 3. Диспетчеризация
- Очередь активных рейсов
- Мониторинг статусов
- Быстрая связь с водителем (чат, звонок)
- Отклонения от маршрута
- Аварийные ситуации

### 4. Аналитика
- Загруженность флота
- KPI водителей
- Эффективность маршрутов
- Расход топлива
- Финансовые отчеты

### 5. Документы
- Генерация ТТН
- Экспорт отчетов в Excel
- Печать путевых листов
- Подписание документов

## Архитектура

```
┌─────────────────────────────────────────┐
│         Electron Main Process           │
│  (Node.js, системные интеграции)        │
└───────────────┬─────────────────────────┘
                │
┌───────────────▼─────────────────────────┐
│      Electron Renderer Process          │
│  (React + TypeScript + Zustand)         │
│                                          │
│  ┌────────────┐  ┌────────────┐         │
│  │   Карта    │  │  Рейсы     │         │
│  │ (Leaflet)  │  │ (Kanban)   │         │
│  └────────────┘  └────────────┘         │
│                                          │
│  ┌────────────┐  ┌────────────┐         │
│  │  Флот      │  │ Аналитика  │         │
│  │  (Table)   │  │ (Charts)   │         │
│  └────────────┘  └────────────┘         │
└───────────────┬─────────────────────────┘
                │
┌───────────────▼─────────────────────────┐
│         Backend API (FastAPI)           │
│    WebSocket for real-time updates      │
└─────────────────────────────────────────┘
```

## План разработки

### Фаза 1: Прототип (1 неделя)
- [ ] Setup Electron + React + TypeScript
- [ ] Базовая навигация
- [ ] Авторизация
- [ ] Главная страница с картой

### Фаза 2: Основной функционал (2 недели)
- [ ] Карта с флотом (real-time updates)
- [ ] Список рейсов с фильтрами
- [ ] Создание/редактирование рейса
- [ ] Назначение водителя на рейс
- [ ] WebSocket интеграция

### Фаза 3: Дополнительные функции (1 неделя)
- [ ] Аналитика и дашборды
- [ ] Печать документов
- [ ] Горячие клавиши
- [ ] Системные уведомления
- [ ] Оффлайн-режим (SQLite кэш)

### Фаза 4: Тестирование и релиз (1 неделя)
- [ ] Unit тесты
- [ ] E2E тесты (Playwright)
- [ ] Сборка для Windows (.exe)
- [ ] Сборка для macOS (.dmg)
- [ ] Code signing

## Бюджет и ресурсы

### Команда
- 1x Electron разработчик (senior): ₽280,000/мес × 1.25 мес = **₽350,000**
- 0.5x Backend разработчик (WebSocket): ₽200,000/мес × 0.5 мес = **₽100,000**
- 0.2x QA Engineer: ₽150,000/мес × 0.2 мес = **₽30,000**

**Итого разработка: ₽480,000**

### Инфраструктура
- MapBox API: **₽60,000/год**
- WebSocket server (AWS/Yandex Cloud): **₽15,000/мес**
- Code Signing Certificate (Windows + macOS): **₽40,000**

**Итого инфраструктура: ₽280,000 первый год**

## Дистрибуция

### Windows
- Автоматические обновления через Squirrel.Windows
- Подпись кода (Authenticode)
- Installer (.exe)

### macOS
- Автоматические обновления через electron-updater
- Нотаризация через Apple
- DMG образ

## Сроки
**Общий срок: 5 недель от старта до релиза**

## KPI успеха
- Переход с веб-версии: 60% диспетчеров в первый месяц
- Среднее время работы в приложении: 4+ часов/день
- Crash-free rate: 99.5%+
- Скорость загрузки карты с 100 ТС: < 2 секунды
- Оффлайн-работа: 95% функций доступны без интернета

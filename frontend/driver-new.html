<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>RoutoX — Панель водителя</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <script src="https://kit.fontawesome.com/a2e0e9e5a9.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <link rel="stylesheet" href="./assets/css/style.css" />
  <style>
    /* iPad/Tablet optimized styles */
    :root {
      --primary: #3b82f6;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
    }

    body {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
      overscroll-behavior: none;
    }

    /* Large touch-friendly buttons */
    .touch-btn {
      min-height: 56px;
      min-width: 56px;
      border-radius: 16px;
      transition: all 0.2s ease;
      -webkit-tap-highlight-color: transparent;
    }

    .touch-btn:active {
      transform: scale(0.95);
    }

    /* Status indicator pulse */
    .status-pulse {
      animation: statusPulse 2s ease-in-out infinite;
    }

    @keyframes statusPulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); }
      50% { box-shadow: 0 0 0 12px rgba(16, 185, 129, 0); }
    }

    /* Quick action cards */
    .quick-action {
      background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 20px;
      padding: 20px;
      transition: all 0.3s ease;
    }

    .quick-action:active {
      transform: scale(0.98);
      border-color: rgba(59, 130, 246, 0.5);
    }

    /* Navigation tabs */
    .nav-tab {
      flex: 1;
      text-align: center;
      padding: 16px 8px;
      border-radius: 16px;
      transition: all 0.3s ease;
    }

    .nav-tab.active {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(16, 185, 129, 0.1));
      border: 1px solid rgba(59, 130, 246, 0.3);
    }

    /* Progress ring */
    .progress-ring {
      transform: rotate(-90deg);
    }

    .progress-ring-circle {
      transition: stroke-dashoffset 0.5s ease;
    }

    /* Swipe card */
    .swipe-card {
      transition: transform 0.3s ease;
    }

    /* Map container */
    #driverMap {
      border-radius: 20px;
      z-index: 1;
    }

    /* Timeline */
    .timeline-item::before {
      content: '';
      position: absolute;
      left: 15px;
      top: 40px;
      bottom: -20px;
      width: 2px;
      background: linear-gradient(to bottom, rgba(59, 130, 246, 0.5), transparent);
    }

    .timeline-item:last-child::before {
      display: none;
    }

    /* ETA countdown */
    .eta-countdown {
      font-variant-numeric: tabular-nums;
      letter-spacing: 0.05em;
    }

    /* Voice command indicator */
    .voice-indicator {
      animation: voicePulse 1.5s ease-in-out infinite;
    }

    @keyframes voicePulse {
      0%, 100% { opacity: 0.5; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.1); }
    }

    /* Rest timer warning */
    .rest-warning {
      animation: restWarning 1s ease-in-out infinite;
    }

    @keyframes restWarning {
      0%, 100% { background-color: rgba(239, 68, 68, 0.2); }
      50% { background-color: rgba(239, 68, 68, 0.4); }
    }

    /* Checklist item */
    .checklist-item {
      transition: all 0.3s ease;
    }

    .checklist-item.checked {
      opacity: 0.5;
      text-decoration: line-through;
    }

    /* Fuel gauge */
    .fuel-gauge {
      background: linear-gradient(to right, 
        rgba(239, 68, 68, 0.8) 0%, 
        rgba(245, 158, 11, 0.8) 25%, 
        rgba(16, 185, 129, 0.8) 50%,
        rgba(16, 185, 129, 0.8) 100%
      );
    }

    /* Weather card */
    .weather-card {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
    }

    /* Document scan overlay */
    .scan-overlay {
      border: 3px dashed rgba(59, 130, 246, 0.5);
      animation: scanPulse 2s ease-in-out infinite;
    }

    @keyframes scanPulse {
      0%, 100% { border-color: rgba(59, 130, 246, 0.5); }
      50% { border-color: rgba(16, 185, 129, 0.8); }
    }
  </style>
</head>
<body class="min-h-screen flex flex-col bg-slate-900">
  <!-- Compact Header for iPad -->
  <header class="glass px-4 py-3 flex items-center justify-between sticky top-0 z-20 safe-area-inset">
    <div class="flex items-center gap-3">
      <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-emerald-500 flex items-center justify-center text-white font-bold">R</div>
      <div>
        <div class="font-semibold">RoutoX</div>
        <div class="text-xs text-slate-400">Панель водителя</div>
      </div>
    </div>
    
    <div class="flex items-center gap-2">
      <!-- Online status -->
      <div class="flex items-center gap-2 px-3 py-1.5 rounded-full bg-emerald-500/20 border border-emerald-500/30">
        <span class="w-2 h-2 rounded-full bg-emerald-400 status-pulse"></span>
        <span class="text-xs text-emerald-300">Онлайн</span>
      </div>
      
      <!-- Notifications -->
      <button id="notifBtn" class="touch-btn w-12 h-12 flex items-center justify-center glass rounded-xl relative">
        <i class="fa-solid fa-bell text-slate-300"></i>
        <span class="absolute -top-1 -right-1 w-5 h-5 rounded-full bg-red-500 text-xs flex items-center justify-center font-bold">3</span>
      </button>
      
      <!-- Emergency SOS -->
      <button id="sosBtn" class="touch-btn w-12 h-12 flex items-center justify-center bg-red-500/20 border border-red-500/50 rounded-xl">
        <i class="fa-solid fa-phone-volume text-red-400"></i>
      </button>
    </div>
  </header>

  <!-- Navigation Tabs -->
  <div class="px-4 py-3 glass border-b border-slate-800">
    <div class="flex gap-2">
      <button class="nav-tab active" data-tab="main">
        <i class="fa-solid fa-gauge-high text-blue-400 text-lg"></i>
        <div class="text-xs mt-1">Главная</div>
      </button>
      <button class="nav-tab" data-tab="route">
        <i class="fa-solid fa-route text-slate-400 text-lg"></i>
        <div class="text-xs mt-1">Маршрут</div>
      </button>
      <button class="nav-tab" data-tab="cargo">
        <i class="fa-solid fa-boxes-stacked text-slate-400 text-lg"></i>
        <div class="text-xs mt-1">Груз</div>
      </button>
      <button class="nav-tab" data-tab="documents">
        <i class="fa-solid fa-file-lines text-slate-400 text-lg"></i>
        <div class="text-xs mt-1">Документы</div>
      </button>
      <button class="nav-tab" data-tab="profile">
        <i class="fa-solid fa-user text-slate-400 text-lg"></i>
        <div class="text-xs mt-1">Профиль</div>
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <main class="flex-1 overflow-y-auto p-4 space-y-4">
    <!-- Tab: Main Dashboard -->
    <div id="tab-main" class="tab-content space-y-4">
      <!-- Current Trip Status -->
      <div class="glass rounded-2xl p-5 border border-slate-800">
        <div class="flex items-center justify-between mb-4">
          <div>
            <div class="text-xs text-slate-400 uppercase tracking-wider">Текущий рейс</div>
            <div class="text-xl font-bold mt-1" id="tripTitle">Москва → Казань</div>
          </div>
          <div class="flex items-center gap-2">
            <span class="px-3 py-1.5 rounded-full bg-blue-500/20 text-blue-300 text-sm font-medium">
              <i class="fa-solid fa-truck mr-1"></i> В пути
            </span>
          </div>
        </div>
        
        <!-- Progress bar -->
        <div class="relative h-3 bg-slate-800 rounded-full overflow-hidden mb-4">
          <div class="absolute inset-y-0 left-0 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-full transition-all duration-500" style="width: 65%"></div>
          <div class="absolute inset-y-0 left-[65%] w-3 h-3 bg-white rounded-full shadow-lg transform -translate-x-1/2"></div>
        </div>
        
        <div class="grid grid-cols-3 gap-4 text-center">
          <div>
            <div class="text-xs text-slate-400">Пройдено</div>
            <div class="text-lg font-bold text-emerald-400">512 км</div>
          </div>
          <div>
            <div class="text-xs text-slate-400">Осталось</div>
            <div class="text-lg font-bold">268 км</div>
          </div>
          <div>
            <div class="text-xs text-slate-400">ETA</div>
            <div class="text-lg font-bold text-blue-400 eta-countdown">17:45</div>
          </div>
        </div>
      </div>

      <!-- Quick Actions Grid -->
      <div class="grid grid-cols-2 gap-3">
        <!-- Start/Stop Navigation -->
        <button class="quick-action flex flex-col items-center justify-center" id="navBtn">
          <div class="w-14 h-14 rounded-full bg-emerald-500/20 flex items-center justify-center mb-3">
            <i class="fa-solid fa-location-arrow text-emerald-400 text-xl"></i>
          </div>
          <div class="font-semibold">Навигация</div>
          <div class="text-xs text-slate-400 mt-1">Яндекс Навигатор</div>
        </button>
        
        <!-- Report Issue -->
        <button class="quick-action flex flex-col items-center justify-center" id="reportBtn">
          <div class="w-14 h-14 rounded-full bg-amber-500/20 flex items-center justify-center mb-3">
            <i class="fa-solid fa-triangle-exclamation text-amber-400 text-xl"></i>
          </div>
          <div class="font-semibold">Сообщить</div>
          <div class="text-xs text-slate-400 mt-1">Проблема на маршруте</div>
        </button>
        
        <!-- Call Dispatcher -->
        <button class="quick-action flex flex-col items-center justify-center" id="callDispatcherBtn">
          <div class="w-14 h-14 rounded-full bg-blue-500/20 flex items-center justify-center mb-3">
            <i class="fa-solid fa-headset text-blue-400 text-xl"></i>
          </div>
          <div class="font-semibold">Диспетчер</div>
          <div class="text-xs text-slate-400 mt-1">Позвонить</div>
        </button>
        
        <!-- Status Change -->
        <button class="quick-action flex flex-col items-center justify-center" id="statusBtn">
          <div class="w-14 h-14 rounded-full bg-purple-500/20 flex items-center justify-center mb-3">
            <i class="fa-solid fa-clock-rotate-left text-purple-400 text-xl"></i>
          </div>
          <div class="font-semibold">Статус</div>
          <div class="text-xs text-slate-400 mt-1">Изменить статус</div>
        </button>
      </div>

      <!-- Rest Time Warning (по законам РФ) -->
      <div class="glass rounded-2xl p-4 border border-amber-500/30 bg-amber-500/10" id="restWarning">
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 rounded-full bg-amber-500/20 flex items-center justify-center flex-shrink-0">
            <i class="fa-solid fa-bed text-amber-400 text-xl"></i>
          </div>
          <div class="flex-1">
            <div class="font-semibold text-amber-300">Время отдыха</div>
            <div class="text-sm text-slate-400 mt-1">
              По закону (ФЗ-196) через <span class="font-bold text-amber-400">1ч 23мин</span> нужен перерыв
            </div>
          </div>
          <button class="touch-btn px-4 py-2 bg-amber-500/20 border border-amber-500/30 rounded-xl text-amber-300 text-sm font-medium">
            Подробнее
          </button>
        </div>
      </div>

      <!-- Vehicle Status -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="flex items-center justify-between mb-4">
          <div class="font-semibold">Состояние ТС</div>
          <span class="text-xs text-emerald-400"><i class="fa-solid fa-check-circle mr-1"></i>Норма</span>
        </div>
        
        <div class="grid grid-cols-2 gap-4">
          <!-- Fuel -->
          <div class="space-y-2">
            <div class="flex items-center justify-between text-sm">
              <span class="text-slate-400"><i class="fa-solid fa-gas-pump mr-2"></i>Топливо</span>
              <span class="font-semibold">62%</span>
            </div>
            <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
              <div class="h-full fuel-gauge rounded-full" style="width: 62%"></div>
            </div>
          </div>
          
          <!-- Temperature -->
          <div class="space-y-2">
            <div class="flex items-center justify-between text-sm">
              <span class="text-slate-400"><i class="fa-solid fa-temperature-half mr-2"></i>Температура</span>
              <span class="font-semibold text-emerald-400">24°C</span>
            </div>
            <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
              <div class="h-full bg-emerald-500 rounded-full" style="width: 50%"></div>
            </div>
          </div>
          
          <!-- Speed -->
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center">
              <i class="fa-solid fa-gauge text-blue-400"></i>
            </div>
            <div>
              <div class="text-xs text-slate-400">Скорость</div>
              <div class="font-semibold">78 км/ч</div>
            </div>
          </div>
          
          <!-- Engine -->
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center">
              <i class="fa-solid fa-engine text-emerald-400"></i>
            </div>
            <div>
              <div class="text-xs text-slate-400">Двигатель</div>
              <div class="font-semibold text-emerald-400">OK</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Weather on Route -->
      <div class="glass rounded-2xl p-4 border border-slate-800 weather-card">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 rounded-xl bg-blue-500/20 flex items-center justify-center">
              <i class="fa-solid fa-cloud-sun text-blue-400 text-xl"></i>
            </div>
            <div>
              <div class="text-sm text-slate-400">Погода на маршруте</div>
              <div class="font-semibold">Переменная облачность, +12°C</div>
            </div>
          </div>
          <div class="text-right">
            <div class="text-xs text-slate-400">Казань</div>
            <div class="text-sm">Дождь к вечеру</div>
          </div>
        </div>
      </div>

      <!-- Upcoming Tasks -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="flex items-center justify-between mb-4">
          <div class="font-semibold">Задачи рейса</div>
          <span class="text-xs text-slate-400">3 из 5</span>
        </div>
        
        <div class="space-y-3">
          <div class="checklist-item checked flex items-center gap-3 p-3 rounded-xl bg-slate-800/50">
            <div class="w-6 h-6 rounded-full bg-emerald-500/20 flex items-center justify-center">
              <i class="fa-solid fa-check text-emerald-400 text-xs"></i>
            </div>
            <span class="text-sm">Принять груз на складе</span>
          </div>
          <div class="checklist-item checked flex items-center gap-3 p-3 rounded-xl bg-slate-800/50">
            <div class="w-6 h-6 rounded-full bg-emerald-500/20 flex items-center justify-center">
              <i class="fa-solid fa-check text-emerald-400 text-xs"></i>
            </div>
            <span class="text-sm">Проверить пломбы</span>
          </div>
          <div class="checklist-item checked flex items-center gap-3 p-3 rounded-xl bg-slate-800/50">
            <div class="w-6 h-6 rounded-full bg-emerald-500/20 flex items-center justify-center">
              <i class="fa-solid fa-check text-emerald-400 text-xs"></i>
            </div>
            <span class="text-sm">Подписать ТТН</span>
          </div>
          <div class="checklist-item flex items-center gap-3 p-3 rounded-xl bg-slate-800/50">
            <div class="w-6 h-6 rounded-full bg-slate-700 flex items-center justify-center">
              <span class="text-xs text-slate-400">4</span>
            </div>
            <span class="text-sm">Позвонить получателю</span>
          </div>
          <div class="checklist-item flex items-center gap-3 p-3 rounded-xl bg-slate-800/50">
            <div class="w-6 h-6 rounded-full bg-slate-700 flex items-center justify-center">
              <span class="text-xs text-slate-400">5</span>
            </div>
            <span class="text-sm">Сдать груз</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab: Route -->
    <div id="tab-route" class="tab-content hidden space-y-4">
      <!-- Map -->
      <div class="glass rounded-2xl overflow-hidden border border-slate-800">
        <div id="driverMap" style="height: 300px;"></div>
      </div>

      <!-- Route Points -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="font-semibold mb-4">Точки маршрута</div>
        
        <div class="space-y-4 relative">
          <div class="timeline-item relative pl-10">
            <div class="absolute left-0 top-0 w-8 h-8 rounded-full bg-emerald-500/20 flex items-center justify-center">
              <i class="fa-solid fa-flag-checkered text-emerald-400 text-xs"></i>
            </div>
            <div class="text-sm font-semibold">Москва, Склад А-12</div>
            <div class="text-xs text-slate-400 mt-1">Отправление: 06:00 • Факт: 06:15</div>
            <div class="text-xs text-emerald-400 mt-1"><i class="fa-solid fa-check mr-1"></i>Выполнено</div>
          </div>
          
          <div class="timeline-item relative pl-10">
            <div class="absolute left-0 top-0 w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center">
              <i class="fa-solid fa-truck text-blue-400 text-xs"></i>
            </div>
            <div class="text-sm font-semibold">Нижний Новгород (транзит)</div>
            <div class="text-xs text-slate-400 mt-1">Расч. время: 12:30</div>
            <div class="text-xs text-blue-400 mt-1"><i class="fa-solid fa-location-dot mr-1"></i>Текущая позиция</div>
          </div>
          
          <div class="timeline-item relative pl-10">
            <div class="absolute left-0 top-0 w-8 h-8 rounded-full bg-slate-700 flex items-center justify-center">
              <i class="fa-solid fa-location-dot text-slate-400 text-xs"></i>
            </div>
            <div class="text-sm font-semibold">Казань, ул. Логистическая, 45</div>
            <div class="text-xs text-slate-400 mt-1">Прибытие: 17:45</div>
            <div class="text-xs text-slate-500 mt-1">Ожидание</div>
          </div>
        </div>
      </div>

      <!-- Nearby POI -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="font-semibold mb-4">Рядом на маршруте</div>
        
        <div class="grid grid-cols-3 gap-3">
          <button class="quick-action py-4 flex flex-col items-center">
            <i class="fa-solid fa-gas-pump text-amber-400 text-xl mb-2"></i>
            <span class="text-xs">АЗС</span>
            <span class="text-xs text-slate-400">2.3 км</span>
          </button>
          <button class="quick-action py-4 flex flex-col items-center">
            <i class="fa-solid fa-utensils text-emerald-400 text-xl mb-2"></i>
            <span class="text-xs">Кафе</span>
            <span class="text-xs text-slate-400">5.1 км</span>
          </button>
          <button class="quick-action py-4 flex flex-col items-center">
            <i class="fa-solid fa-square-parking text-blue-400 text-xl mb-2"></i>
            <span class="text-xs">Парковка</span>
            <span class="text-xs text-slate-400">8.7 км</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Tab: Cargo -->
    <div id="tab-cargo" class="tab-content hidden space-y-4">
      <!-- Cargo Summary -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="flex items-center justify-between mb-4">
          <div class="font-semibold">Информация о грузе</div>
          <span class="px-2 py-1 rounded-full bg-emerald-500/20 text-emerald-300 text-xs">Сохранность OK</span>
        </div>
        
        <div class="grid grid-cols-2 gap-4">
          <div class="p-3 rounded-xl bg-slate-800/50">
            <div class="text-xs text-slate-400">Тип груза</div>
            <div class="font-semibold mt-1">Электроника</div>
          </div>
          <div class="p-3 rounded-xl bg-slate-800/50">
            <div class="text-xs text-slate-400">Вес</div>
            <div class="font-semibold mt-1">4,150 кг</div>
          </div>
          <div class="p-3 rounded-xl bg-slate-800/50">
            <div class="text-xs text-slate-400">Объём</div>
            <div class="font-semibold mt-1">28 м³</div>
          </div>
          <div class="p-3 rounded-xl bg-slate-800/50">
            <div class="text-xs text-slate-400">Мест</div>
            <div class="font-semibold mt-1">24 паллеты</div>
          </div>
        </div>
      </div>

      <!-- Temperature Monitoring -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="flex items-center justify-between mb-4">
          <div class="font-semibold">Мониторинг температуры</div>
          <span class="text-xs text-slate-400">Обновлено 2 мин назад</span>
        </div>
        
        <div class="flex items-center justify-center py-6">
          <div class="relative">
            <svg class="progress-ring w-32 h-32">
              <circle cx="64" cy="64" r="56" stroke="#1e293b" stroke-width="8" fill="none"/>
              <circle class="progress-ring-circle" cx="64" cy="64" r="56" stroke="#10b981" stroke-width="8" fill="none"
                stroke-dasharray="352" stroke-dashoffset="70" stroke-linecap="round"/>
            </svg>
            <div class="absolute inset-0 flex flex-col items-center justify-center">
              <span class="text-3xl font-bold">+4°C</span>
              <span class="text-xs text-slate-400">Норма: +2...+8°C</span>
            </div>
          </div>
        </div>
        
        <div class="flex justify-between text-xs text-slate-400 mt-4">
          <span>Мин: +3°C</span>
          <span>Макс: +6°C</span>
        </div>
      </div>

      <!-- Seals Status -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="flex items-center justify-between mb-4">
          <div class="font-semibold">Пломбы</div>
          <button class="text-xs text-blue-400">Сканировать</button>
        </div>
        
        <div class="space-y-3">
          <div class="flex items-center justify-between p-3 rounded-xl bg-slate-800/50">
            <div class="flex items-center gap-3">
              <i class="fa-solid fa-lock text-emerald-400"></i>
              <span class="text-sm">Пломба #АБ-123456</span>
            </div>
            <span class="text-xs text-emerald-400">Целая</span>
          </div>
          <div class="flex items-center justify-between p-3 rounded-xl bg-slate-800/50">
            <div class="flex items-center gap-3">
              <i class="fa-solid fa-lock text-emerald-400"></i>
              <span class="text-sm">Пломба #АБ-123457</span>
            </div>
            <span class="text-xs text-emerald-400">Целая</span>
          </div>
        </div>
      </div>

      <!-- Photo Report -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="flex items-center justify-between mb-4">
          <div class="font-semibold">Фотоотчёт</div>
          <span class="text-xs text-slate-400">4 фото</span>
        </div>
        
        <div class="grid grid-cols-4 gap-2">
          <div class="aspect-square bg-slate-800 rounded-xl flex items-center justify-center">
            <i class="fa-solid fa-image text-slate-600 text-xl"></i>
          </div>
          <div class="aspect-square bg-slate-800 rounded-xl flex items-center justify-center">
            <i class="fa-solid fa-image text-slate-600 text-xl"></i>
          </div>
          <div class="aspect-square bg-slate-800 rounded-xl flex items-center justify-center">
            <i class="fa-solid fa-image text-slate-600 text-xl"></i>
          </div>
          <button class="aspect-square bg-blue-500/20 border border-blue-500/30 rounded-xl flex items-center justify-center">
            <i class="fa-solid fa-camera text-blue-400 text-xl"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Tab: Documents -->
    <div id="tab-documents" class="tab-content hidden space-y-4">
      <!-- Document List -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="flex items-center justify-between mb-4">
          <div class="font-semibold">Документы рейса</div>
          <button class="touch-btn px-3 py-1.5 bg-blue-500/20 border border-blue-500/30 rounded-lg text-blue-300 text-sm">
            <i class="fa-solid fa-plus mr-1"></i>Добавить
          </button>
        </div>
        
        <div class="space-y-3">
          <div class="flex items-center justify-between p-4 rounded-xl bg-slate-800/50">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center">
                <i class="fa-solid fa-file-lines text-emerald-400"></i>
              </div>
              <div>
                <div class="text-sm font-semibold">ТТН №12345</div>
                <div class="text-xs text-slate-400">Подписан</div>
              </div>
            </div>
            <button class="text-blue-400 text-sm">Открыть</button>
          </div>
          
          <div class="flex items-center justify-between p-4 rounded-xl bg-slate-800/50">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center">
                <i class="fa-solid fa-route text-blue-400"></i>
              </div>
              <div>
                <div class="text-sm font-semibold">Путевой лист</div>
                <div class="text-xs text-slate-400">Активен</div>
              </div>
            </div>
            <button class="text-blue-400 text-sm">Открыть</button>
          </div>
          
          <div class="flex items-center justify-between p-4 rounded-xl bg-slate-800/50">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center">
                <i class="fa-solid fa-clipboard-check text-amber-400"></i>
              </div>
              <div>
                <div class="text-sm font-semibold">Акт приёма</div>
                <div class="text-xs text-amber-400">Ожидает подписи</div>
              </div>
            </div>
            <button class="text-blue-400 text-sm">Подписать</button>
          </div>
        </div>
      </div>

      <!-- Scan Document -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="font-semibold mb-4">Сканировать документ</div>
        <div class="aspect-[4/3] bg-slate-800 rounded-xl scan-overlay flex flex-col items-center justify-center">
          <i class="fa-solid fa-camera text-4xl text-slate-500 mb-3"></i>
          <span class="text-sm text-slate-400">Наведите камеру на документ</span>
        </div>
        <button class="touch-btn w-full mt-4 py-4 bg-blue-500/20 border border-blue-500/30 rounded-xl text-blue-300 font-semibold">
          <i class="fa-solid fa-qrcode mr-2"></i>Сканировать QR/штрихкод
        </button>
      </div>
    </div>

    <!-- Tab: Profile -->
    <div id="tab-profile" class="tab-content hidden space-y-4">
      <!-- Driver Info -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="flex items-center gap-4 mb-4">
          <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-emerald-500 flex items-center justify-center text-white text-2xl font-bold">
            ИП
          </div>
          <div>
            <div class="font-semibold text-lg">Иванов Пётр Сергеевич</div>
            <div class="text-sm text-slate-400">Водитель категории E</div>
            <div class="text-xs text-emerald-400 mt-1">
              <i class="fa-solid fa-star mr-1"></i>Рейтинг: 4.9
            </div>
          </div>
        </div>
        
        <div class="grid grid-cols-2 gap-3">
          <div class="p-3 rounded-xl bg-slate-800/50">
            <div class="text-xs text-slate-400">Рейсов за месяц</div>
            <div class="font-semibold text-lg mt-1">24</div>
          </div>
          <div class="p-3 rounded-xl bg-slate-800/50">
            <div class="text-xs text-slate-400">Пробег за месяц</div>
            <div class="font-semibold text-lg mt-1">12,450 км</div>
          </div>
        </div>
      </div>

      <!-- Work Time Stats (по ФЗ-196) -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="flex items-center justify-between mb-4">
          <div class="font-semibold">Режим труда и отдыха</div>
          <span class="text-xs text-slate-400">ФЗ-196</span>
        </div>
        
        <div class="space-y-4">
          <div>
            <div class="flex items-center justify-between text-sm mb-2">
              <span class="text-slate-400">Время за рулём сегодня</span>
              <span class="font-semibold">6ч 37мин / 9ч</span>
            </div>
            <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
              <div class="h-full bg-blue-500 rounded-full" style="width: 73%"></div>
            </div>
          </div>
          
          <div>
            <div class="flex items-center justify-between text-sm mb-2">
              <span class="text-slate-400">Время за неделю</span>
              <span class="font-semibold">38ч / 56ч</span>
            </div>
            <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
              <div class="h-full bg-emerald-500 rounded-full" style="width: 68%"></div>
            </div>
          </div>
          
          <div>
            <div class="flex items-center justify-between text-sm mb-2">
              <span class="text-slate-400">Отдых между сменами</span>
              <span class="font-semibold text-emerald-400">11ч (норма)</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Vehicle Info -->
      <div class="glass rounded-2xl p-4 border border-slate-800">
        <div class="font-semibold mb-4">Моё транспортное средство</div>
        
        <div class="flex items-center gap-4 p-4 rounded-xl bg-slate-800/50">
          <div class="w-16 h-16 rounded-xl bg-blue-500/20 flex items-center justify-center">
            <i class="fa-solid fa-truck text-blue-400 text-2xl"></i>
          </div>
          <div>
            <div class="font-semibold">MAN TGX 18.510</div>
            <div class="text-sm text-slate-400">А 123 ВС 777</div>
            <div class="text-xs text-emerald-400 mt-1">
              <i class="fa-solid fa-circle mr-1"></i>Исправен
            </div>
          </div>
        </div>
        
        <div class="grid grid-cols-2 gap-3 mt-4">
          <button class="quick-action py-3 flex items-center justify-center gap-2">
            <i class="fa-solid fa-clipboard-list text-blue-400"></i>
            <span class="text-sm">Предрейсовый осмотр</span>
          </button>
          <button class="quick-action py-3 flex items-center justify-center gap-2">
            <i class="fa-solid fa-triangle-exclamation text-amber-400"></i>
            <span class="text-sm">Сообщить о поломке</span>
          </button>
        </div>
      </div>

      <!-- Logout -->
      <button id="logoutBtn" class="touch-btn w-full py-4 bg-red-500/20 border border-red-500/30 rounded-xl text-red-300 font-semibold">
        <i class="fa-solid fa-right-from-bracket mr-2"></i>Выйти из аккаунта
      </button>
    </div>
  </main>

  <!-- Status Change Modal -->
  <div id="statusModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
    <div class="glass rounded-3xl p-6 w-full max-w-md border border-slate-700">
      <div class="flex items-center justify-between mb-6">
        <div class="font-semibold text-lg">Изменить статус</div>
        <button onclick="closeStatusModal()" class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>
      
      <div class="space-y-3">
        <button class="w-full p-4 rounded-xl bg-blue-500/20 border border-blue-500/30 text-left flex items-center gap-3">
          <i class="fa-solid fa-truck text-blue-400"></i>
          <span>В пути</span>
        </button>
        <button class="w-full p-4 rounded-xl bg-slate-800/50 border border-slate-700 text-left flex items-center gap-3">
          <i class="fa-solid fa-box-open text-amber-400"></i>
          <span>На погрузке</span>
        </button>
        <button class="w-full p-4 rounded-xl bg-slate-800/50 border border-slate-700 text-left flex items-center gap-3">
          <i class="fa-solid fa-dolly text-emerald-400"></i>
          <span>На разгрузке</span>
        </button>
        <button class="w-full p-4 rounded-xl bg-slate-800/50 border border-slate-700 text-left flex items-center gap-3">
          <i class="fa-solid fa-mug-hot text-purple-400"></i>
          <span>Перерыв</span>
        </button>
        <button class="w-full p-4 rounded-xl bg-slate-800/50 border border-slate-700 text-left flex items-center gap-3">
          <i class="fa-solid fa-bed text-indigo-400"></i>
          <span>Отдых (ночёвка)</span>
        </button>
        <button class="w-full p-4 rounded-xl bg-slate-800/50 border border-slate-700 text-left flex items-center gap-3">
          <i class="fa-solid fa-gas-pump text-orange-400"></i>
          <span>Заправка</span>
        </button>
        <button class="w-full p-4 rounded-xl bg-red-500/20 border border-red-500/30 text-left flex items-center gap-3">
          <i class="fa-solid fa-triangle-exclamation text-red-400"></i>
          <span>Проблема / ДТП</span>
        </button>
      </div>
    </div>
  </div>

  <!-- SOS Modal -->
  <div id="sosModal" class="fixed inset-0 bg-red-900/60 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
    <div class="glass rounded-3xl p-6 w-full max-w-md border border-red-500/50">
      <div class="text-center">
        <div class="w-20 h-20 rounded-full bg-red-500/20 flex items-center justify-center mx-auto mb-4">
          <i class="fa-solid fa-phone-volume text-red-400 text-3xl"></i>
        </div>
        <div class="font-bold text-xl mb-2">Экстренный вызов</div>
        <div class="text-sm text-slate-400 mb-6">Выберите тип экстренной ситуации</div>
        
        <div class="space-y-3">
          <button class="w-full p-4 rounded-xl bg-red-500 text-white font-semibold flex items-center justify-center gap-2">
            <i class="fa-solid fa-truck-medical"></i>
            <span>Скорая помощь (112)</span>
          </button>
          <button class="w-full p-4 rounded-xl bg-amber-500 text-white font-semibold flex items-center justify-center gap-2">
            <i class="fa-solid fa-car-burst"></i>
            <span>ДТП / ГИБДД</span>
          </button>
          <button class="w-full p-4 rounded-xl bg-blue-500 text-white font-semibold flex items-center justify-center gap-2">
            <i class="fa-solid fa-headset"></i>
            <span>Диспетчер компании</span>
          </button>
        </div>
        
        <button onclick="closeSosModal()" class="mt-6 text-sm text-slate-400">Отмена</button>
      </div>
    </div>
  </div>

  <script>
    // Tab navigation
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        // Update tab styles
        document.querySelectorAll('.nav-tab').forEach(t => {
          t.classList.remove('active');
          t.querySelector('i').classList.remove('text-blue-400');
          t.querySelector('i').classList.add('text-slate-400');
        });
        tab.classList.add('active');
        tab.querySelector('i').classList.remove('text-slate-400');
        tab.querySelector('i').classList.add('text-blue-400');
        
        // Show corresponding content
        const tabId = tab.dataset.tab;
        document.querySelectorAll('.tab-content').forEach(content => {
          content.classList.add('hidden');
        });
        document.getElementById(`tab-${tabId}`).classList.remove('hidden');
        
        // Initialize map if route tab
        if (tabId === 'route') {
          initMap();
        }
      });
    });

    // Initialize map
    let map = null;
    function initMap() {
      if (map) return;
      
      map = L.map('driverMap').setView([55.7558, 49.1320], 6);
      L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
        attribution: '© OpenStreetMap'
      }).addTo(map);
      
      // Route line
      const routeCoords = [
        [55.7558, 37.6173], // Moscow
        [56.3269, 44.0059], // Nizhny Novgorod
        [55.7963, 49.1088]  // Kazan
      ];
      
      L.polyline(routeCoords, {
        color: '#3b82f6',
        weight: 4,
        opacity: 0.8
      }).addTo(map);
      
      // Current position marker
      const currentPos = [56.0, 42.5];
      L.marker(currentPos, {
        icon: L.divIcon({
          className: 'custom-marker',
          html: '<div style="width:32px;height:32px;background:linear-gradient(135deg,#3b82f6,#10b981);border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;border:3px solid white;box-shadow:0 4px 12px rgba(0,0,0,0.3);"><i class="fa-solid fa-truck" style="font-size:12px;"></i></div>',
          iconSize: [32, 32],
          iconAnchor: [16, 16]
        })
      }).addTo(map);
    }

    // Status modal
    document.getElementById('statusBtn')?.addEventListener('click', () => {
      document.getElementById('statusModal').classList.remove('hidden');
      document.getElementById('statusModal').classList.add('flex');
    });

    function closeStatusModal() {
      document.getElementById('statusModal').classList.add('hidden');
      document.getElementById('statusModal').classList.remove('flex');
    }

    // SOS modal
    document.getElementById('sosBtn')?.addEventListener('click', () => {
      document.getElementById('sosModal').classList.remove('hidden');
      document.getElementById('sosModal').classList.add('flex');
    });

    function closeSosModal() {
      document.getElementById('sosModal').classList.add('hidden');
      document.getElementById('sosModal').classList.remove('flex');
    }

    // Navigation button - open Yandex Navigator
    document.getElementById('navBtn')?.addEventListener('click', () => {
      const destination = '55.7963,49.1088'; // Kazan coordinates
      window.open(`yandexnavi://build_route_on_map?lat_to=55.7963&lon_to=49.1088`, '_blank');
    });

    // Checklist items
    document.querySelectorAll('.checklist-item:not(.checked)').forEach(item => {
      item.addEventListener('click', () => {
        item.classList.add('checked');
        const icon = item.querySelector('div');
        icon.classList.remove('bg-slate-700');
        icon.classList.add('bg-emerald-500/20');
        icon.innerHTML = '<i class="fa-solid fa-check text-emerald-400 text-xs"></i>';
      });
    });

    // Logout
    document.getElementById('logoutBtn')?.addEventListener('click', () => {
      if (confirm('Вы уверены, что хотите выйти?')) {
        localStorage.removeItem('token');
        window.location.href = './login.html';
      }
    });

    // Update ETA countdown
    function updateETA() {
      const etaEl = document.querySelector('.eta-countdown');
      if (etaEl) {
        // Simulated countdown
        const now = new Date();
        const eta = new Date();
        eta.setHours(17, 45, 0);
        const diff = eta - now;
        if (diff > 0) {
          const hours = Math.floor(diff / (1000 * 60 * 60));
          const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
          etaEl.textContent = `${hours}ч ${mins}м`;
        }
      }
    }
    setInterval(updateETA, 60000);
  </script>
</body>
</html>
